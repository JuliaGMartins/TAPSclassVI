# -*- coding: utf-8 -*-
"""ProcessamentodeImagemAula5.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1uJ0aF-EzbFwUYnakXh0ci4OLEpVetZND
"""

import numpy as np
import matplotlib.pyplot as plt
import cv2
from PIL import Image, ImageFilter

img = cv2.imread('fig.jpg', cv2.IMREAD_GRAYSCALE)

#Filtro da média
def filtro_media (img):
    n = 3
    borda = (n-1)//2
    filtro = np.array([[1,2,1],[2,4,2],[1,2,1]]) / 16
    altura, largura = img.shape
    imagem = np.zeros((altura,largura))

    for x in range(borda, altura - borda):
      for y in range(borda, largura - borda):
        janela= img[x-borda:x+borda+1,y-borda:y+borda+1]
        imagem[x,y] = np.sum(filtro * janela)

    plt.imshow(imagem, cmap= 'gray')
    plt.show()

#Filtro da média
def filtro_media2 (img):
    n = 5
    borda = (n-1)//2
    altura, largura = img.shape
    filtro = np.ones((n,n))/n**2
    imagem = np.zeros((altura,largura))

    for x in range(borda, altura - borda):
      for y in range(borda, largura - borda):
        janela= img[x-borda:x+borda+1,y-borda:y+borda+1]
        imagem[x,y] = np.sum(filtro * janela)

    plt.imshow(imagem, cmap= 'gray')
    plt.show()

#filtro passa-alta / laplaciana
def filtro_laplaciano (img):
    n = 3
    borda = (n-1)//2
    filtro = np.array([[0,1,0],[1,-4,1],[0,1,0]])
    altura, largura = img.shape
    imagem = np.zeros((altura,largura))

    for x in range(borda, altura - borda):
      for y in range(borda, largura - borda):
        janela= img[x-borda:x+borda+1,y-borda:y+borda+1]
        imagem[x,y] = np.sum(filtro * janela)

    plt.imshow(imagem, cmap='gray', vmax=255, vmin=0)
    plt.show()

#filtro sobel dy
def filtro_sobel_dy (img):
    n = 3
    borda = (n-1)//2
    filtro = np.array([[-1,0,1],[-2,0,2],[-1,0,1]])
    altura, largura = img.shape
    dy = np.zeros((altura,largura))

    for x in range(borda, altura - borda):
      for y in range(borda, largura - borda):
        janela= img[x-borda:x+borda+1,y-borda:y+borda+1]
        dy[x,y] = np.sum(filtro * janela)

    return dy

#filtro sobel dx
def filtro_sobel_dx (img):
    n = 3
    borda = (n-1)//2
    filtro = np.array([[-1,-2,-1],[0,0,0],[1,2,1]])
    altura, largura = img.shape
    dx = np.zeros((altura,largura))

    for x in range(borda, altura - borda):
      for y in range(borda, largura - borda):
        janela= img[x-borda:x+borda+1,y-borda:y+borda+1]
        dx[x,y] = np.sum(filtro*janela)

    return dx

#magnitude da imagem dada pelo dx e dy, obtendo as bordas
def magnitude (img):
    dx = filtro_sobel_dx(img)
    dy = filtro_sobel_dy(img)
    magnitude = np.sqrt(dx**2 + dy**2)
    return magnitude

#magnitune + imagem, destacando as bordas
def magnitude_mais_img (img):
    return img+magnitude(img)

def show_img(img, fig, plot_index):
    fig.add_subplot(*plot_index)
    plt.imshow(img, cmap= 'gray', vmax=255, vmin=0)

fig = plt.figure()
show_img(img, fig, (1,2,1))
show_img(magnitude_mais_img(img), fig, (1,2,2))
plt.show()
